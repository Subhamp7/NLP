import numpy as np
from ast import literal_eval
import time


hist_data =[{'_id': ('60b126706213650309974efa'), 'Clause': '110355 of ', 'Clarification sought / modification suggested': '110355', 'As per Tender': '110355', 'file': '', 'query_id': '05O1M55VNMSU', 'sender_id': '6087c748341850b0a586a2db', 'zone': 'Delhi', 'pr_count': 1, 'cutoff_time': '30-05-2021', 'recipient_id': 'replier@nhai.in', 'status': 'approved', 'upc_code': '0301/01/01/DL', 'Clarification': 'rep', 'created_on': '28-05-2021', 'contract_type': 'EPC', 'id': '05O1M55VNMSU', 'last_mail': '', 'recipient_user': {'department': {'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, 'designation': 'Engineer', 'email': 'replier@nhai.in', 'id': '6045e470b53c3421c5db3e68', 'is_deleted': False, 'name': 'Test_Replier1', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '5d0e12ee10158af49d02ff22f0d59df9', 'title': 'Contract Management'}, {'id': '67ec0b59227d3f9d4e3230182eff8e95', 'title': 'Civil'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'approved_on': '28-05-2021', 'text': '110355 110355 110355 of  rep', 'clean_text': '110355 110355 110355 rep', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60b13164ebc9a976e4f1d1d5'), 'Clause': 'REST of ', 'Clarification sought / modification suggested': 'REST', 'As per Tender': 'REST', 'file': '', 'query_id': 'I08RN2PYM6I4', 'sender_id': '6087c748341850b0a586a2db', 'zone': 'Delhi', 'pr_count': 0, 'cutoff_time': '30-05-2021', 'recipient_id': 'replier@nhai.in', 'status': 'approved', 'upc_code': '0301/01/01/DL', 'Clarification': 'okay\n', 'created_on': '28-05-2021', 'contract_type': 'EPC', 'id': 'I08RN2PYM6I4', 'last_mail': '', 'recipient_user': {'department': {'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, 'designation': 'Engineer', 'email': 'replier@nhai.in', 'id': '6045e470b53c3421c5db3e68', 'is_deleted': False, 'name': 'Test_Replier1', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '5d0e12ee10158af49d02ff22f0d59df9', 'title': 'Contract Management'}, {'id': '67ec0b59227d3f9d4e3230182eff8e95', 'title': 'Civil'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'approved_on': '28-05-2021', 'text': 'REST REST REST of  okay\n', 'clean_text': 'rest rest rest okay', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60b13478f4c166ac1003b3b0'), 'upc_code': '0301/01/01/DL', 'As per Tender': ' 30 lakhs', 'Clarification sought / modification suggested': 'Please let us know the deadline', 'Clause': 'Clause 1.4.2(a) of DCA laning of highway', 'cutoff_time': '30-05-2021', 'recipient_id': 'replier@nhai.in', 'recipient_user': {'department': {'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, 'designation': 'Engineer', 'email': 'replier@nhai.in', 'id': '6045e470b53c3421c5db3e68', 'is_deleted': False, 'name': 'Test_Replier1', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '5d0e12ee10158af49d02ff22f0d59df9', 'title': 'Contract Management'}, {'id': '67ec0b59227d3f9d4e3230182eff8e95', 'title': 'Civil'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': {'email': 'subham306952@gmail.com'}, 'status': 'approved', 'Clarification': 'reply1', 'pr_count': 0, 'text': ' 30 lakhs Please let us know the deadline Clause 1.4.2(a) of DCA laning of highway reply1', 'clean_text': '30 lakh pleas let us know deadlin claus 142a dca lane highway reply1', 'zone': 'Delhi', 'query_id': 'WKOMYDON2JSN', 'created_on': '28-05-2021', 'contract_type': 'EPC', 'approved_on': '28-05-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60b1343268218d06e5226b08'), 'Clause': 'yyyyy of DCA', 'Clarification sought / modification suggested': 'yyyyy', 'As per Tender': 'yyyyy', 'file': 'DCA', 'query_id': 'L50CQPWH58CF', 'sender_id': '6087c748341850b0a586a2db', 'zone': 'Delhi', 'pr_count': 0, 'cutoff_time': '30-05-2021', 'recipient_id': 'replier@nhai.in', 'status': 'approved', 'upc_code': '0301/01/01/DL', 'Clarification': 'okkkkkk\n', 'created_on': '28-05-2021', 'contract_type': 'EPC', 'id': 'L50CQPWH58CF', 'last_mail': '', 'recipient_user': {'department': {'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, 'designation': 'Engineer', 'email': 'replier@nhai.in', 'id': '6045e470b53c3421c5db3e68', 'is_deleted': False, 'name': 'Test_Replier1', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '5d0e12ee10158af49d02ff22f0d59df9', 'title': 'Contract Management'}, {'id': '67ec0b59227d3f9d4e3230182eff8e95', 'title': 'Civil'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'approved_on': '29-05-2021', 'text': 'yyyyy yyyyy yyyyy of DCA okkkkkk\n', 'clean_text': 'yyyyy yyyyy yyyyy dca okkkkkk', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60b3a548eaa03955dbaeb0e4'), 'Clause': 't of ', 'Clarification sought / modification suggested': 't', 'As per Tender': 't', 'file': '', 'query_id': 'DZ98A0LGXB8T', 'sender_id': '6087c748341850b0a586a2db', 'zone': 'Delhi', 'pr_count': 0, 'cutoff_time': '', 'recipient_id': '', 'status': 'approved', 'upc_code': '0301/01/01/DL', 'Clarification': '', 'created_on': '30-05-2021', 'contract_type': 'EPC', 'approved_on': '10-06-2021', 'text': 't t t of  ', 'clean_text': '', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60c21efbb8dedc943d8ac491'), 'upc_code': '0301/01/01/DL', 'As per Tender': 'The cost of the project is 30 lakhs', 'Clarification sought / modification suggested': 'Please let us know the deadline', 'Clause': 'Article 31.1.2 of DCA', 'cutoff_time': '07-08-2021', 'recipient_id': 'replier@nhai.in', 'recipient_user': {'department': {'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, 'designation': 'Engineer', 'email': 'replier@nhai.in', 'id': '6045e470b53c3421c5db3e68', 'is_deleted': False, 'name': 'Test_Replier1', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '5d0e12ee10158af49d02ff22f0d59df9', 'title': 'Contract Management'}, {'id': '67ec0b59227d3f9d4e3230182eff8e95', 'title': 'Civil'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': '6087c748341850b0a586a2db', 'status': 'approved', 'Clarification': '', 'pr_count': 0, 'text': 'The cost of the project is 30 lakhs Please let us know the deadline Article 31.1.2 of DCA ', 'clean_text': 'the cost project 30 lakh pleas let us know deadlin articl 3112 dca', 'zone': 'Delhi', 'query_id': 'DZ98A0LGXB8T', 'created_on': '10-06-2021', 'contract_type': 'EPC', 'id': '1N3BH88BW4BC', 'last_mail': '', 'approved_on': '10-06-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60acb51b8538892e1eb4e190'), 'upc_code': '0301/01/01/DL', 'As per Tender': 'The cost of the project is 30 lakhs', 'Clarification sought / modification suggested': 'Please let us know the deadline', 'Clause': 'Clause 1.4.2(a) of DCA laning of highway', 'cutoff_time': '30-04-2021', 'recipient_id': 'replier@nhai.in', 'recipient_user': {'department': {'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, 'designation': 'Engineer', 'email': 'replier@nhai.in', 'id': '6045e470b53c3421c5db3e68', 'is_deleted': False, 'name': 'Test_Replier1', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '5d0e12ee10158af49d02ff22f0d59df9', 'title': 'Contract Management'}, {'id': '67ec0b59227d3f9d4e3230182eff8e95', 'title': 'Civil'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': {'email': 'subham306952@gmail.com'}, 'status': 'approved', 'Clarification': '', 'pr_count': 35, 'text': 'The cost of the project is 30 lakhs Please let us know the deadline Clause 1.4.2(a) of DCA laning of highway ', 'clean_text': 'the cost project 30 lakh pleas let us know deadlin claus 142a dca lane highway', 'zone': 'Delhi', 'query_id': 'VKKX21W02LGH', 'created_on': '27-04-2021', 'contract_type': 'EPC', 'approved_on': '10-06-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('608810b45ce2e6da650c657c'), 'upc_code': '0301/01/01/DL', 'As per Tender': 'The cost of the project is 30 lakhs', 'Clarification sought / modification suggested': 'Please let us know the deadline', 'Clause': 'Clause 1.4.2(a) of DCA laning of highway', 'cutoff_time': '30-04-2021', 'recipient_id': 'replier@nhai.in', 'recipient_user': {'department': {'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, 'designation': 'Engineer', 'email': 'replier@nhai.in', 'id': '6045e470b53c3421c5db3e68', 'is_deleted': False, 'name': 'Test_Replier1', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '5d0e12ee10158af49d02ff22f0d59df9', 'title': 'Contract Management'}, {'id': '67ec0b59227d3f9d4e3230182eff8e95', 'title': 'Civil'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': {'email': 'subham306952@gmail.com'}, 'status': 'approved', 'Clarification': 'ok\n', 'pr_count': 51, 'text': 'The cost of the project is 30 lakhs Please let us know the deadline Clause 1.4.2(a) of DCA laning of highway ok\n', 'clean_text': 'the cost project 30 lakh pleas let us know deadlin claus 142a dca lane highway ok', 'zone': 'Delhi', 'query_id': 'VKKX21W02LGJ', 'created_on': '27-04-2021', 'contract_type': 'EPC', 'approved_on': '10-06-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60b3a517eaa03955dbaeb0e3'), 'Clause': 'r of ', 'Clarification sought / modification suggested': 'r', 'As per Tender': 'r', 'file': '', 'query_id': '1LTLO4HX4HK7', 'sender_id': '6087c748341850b0a586a2db', 'zone': 'Delhi', 'pr_count': 0, 'cutoff_time': '01-06-2021', 'recipient_id': 'replier@nhai.in', 'status': 'approved', 'upc_code': '0301/01/01/DL', 'Clarification': '', 'created_on': '30-05-2021', 'contract_type': 'EPC', 'id': '1LTLO4HX4HK7', 'last_mail': '', 'recipient_user': {'department': {'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, 'designation': 'Engineer', 'email': 'replier@nhai.in', 'id': '6045e470b53c3421c5db3e68', 'is_deleted': False, 'name': 'Test_Replier1', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '5d0e12ee10158af49d02ff22f0d59df9', 'title': 'Contract Management'}, {'id': '67ec0b59227d3f9d4e3230182eff8e95', 'title': 'Civil'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'approved_on': '10-06-2021', 'text': 'r r r of  ', 'clean_text': 'r r r', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60d2de2fdd9ef16cc2ddc9fa'), 'Clause': '1.3 of DCA', 'Clarification sought / modification suggested': 'TEST_1', 'As per Tender': 'TEST_1', 'file': {'category': 'standard', 'name': 'DCA.pdf', 'type': 'DCA'}, 'clause_meta': {'annexure_name': '', 'clause_num': '1.3', 'heading': 'Article/ Clause', 'schedule_name': ''}, 'query_id': 'GET3CM49A9JT', 'sender_id': '60d06882f6c8b6f93e469b7f', 'zone': 'Delhi', 'pr_count': 0, 'cutoff_time': '26-06-2021', 'recipient_id': 'sachin@envirya.in', 'status': 'approved', 'upc_code': '0301/01/01/DL', 'Clarification': 'TEST_46', 'created_on': '23-06-2021', 'contract_type': 'EPC', 'id': 'GET3CM49A9JT', 'last_mail': '', 'recipient_user': {'department': {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, 'designation': 'IT', 'email': 'sachin@envirya.in', 'id': '60d04eb7e805768ebee9229d', 'is_deleted': False, 'name': 'Sachin', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, {'id': 'c9ca4627f68575a54d3ad4bf23df13b4', 'title': 'Content Writing'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'approved_on': '23-06-2021', 'text': 'TEST_1 TEST_1 1.3 of DCA TEST_46', 'clean_text': 'test1 test1 13 dca test46', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60d2e14b90751c3fa1da23dc'), 'Clause': 'TEST_45', 'Clarification sought / modification suggested': 'TEST_45', 'As per Tender': 'TEST_45', 'file': {'category': 'additional', 'name': '', 'type': ''}, 'clause_meta': {'annexure_name': '', 'clause_num': '', 'heading': 'Article/ Clause', 'schedule_name': ''}, 'query_id': '2H6SJ65G5RD2', 'sender_id': '60d06882f6c8b6f93e469b7f', 'zone': 'Delhi', 'pr_count': 0, 'cutoff_time': '24-06-2021', 'recipient_id': 'sachin@envirya.in', 'status': 'approved', 'upc_code': '0301/01/01/DL', 'Clarification': 'DUMMY REPLY', 'created_on': '23-06-2021', 'contract_type': 'EPC', 'id': '2H6SJ65G5RD2', 'last_mail': '', 'recipient_user': {'department': {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, 'designation': 'IT', 'email': 'sachin@envirya.in', 'id': '60d04eb7e805768ebee9229d', 'is_deleted': False, 'name': 'Sachin', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, {'id': 'c9ca4627f68575a54d3ad4bf23df13b4', 'title': 'Content Writing'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'approved_on': '23-06-2021', 'text': 'TEST_45 TEST_45 TEST_45 DUMMY REPLY', 'clean_text': 'test45 test45 test45 dummi repli', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60d5b1447892909c5e5aa95b'), 'Clause': 'Section 4.1 of RFP RESULT', 'Clarification sought / modification suggested': 'Branch', 'As per Tender': 'Branch', 'file': {'category': 'standard', 'name': 'RFp_Final.pdf', 'type': 'RFP'}, 'clause_meta': {'annex_name': '', 'annexure_name': '', 'appendix_name': '', 'clause_num': '', 'heading': 'Section', 'schedule_name': '', 'section_name': '4.1'}, 'query_id': '76O2G1I99OPR', 'sender_id': '60d06882f6c8b6f93e469b7f', 'zone': 'Delhi', 'pr_count': 0, 'cutoff_time': '26-06-2021', 'recipient_id': 'sachin@envirya.in', 'status': 'approved', 'upc_code': '0301/01/01/DL', 'Clarification': 'TEST_REPLY ', 'created_on': '25-06-2021', 'contract_type': 'EPC', 'id': '76O2G1I99OPR', 'last_mail': '', 'recipient_user': {'department': {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, 'designation': 'IT', 'email': 'sachin@envirya.in', 'id': '60d04eb7e805768ebee9229d', 'is_deleted': False, 'name': 'Sachin', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, {'id': 'c9ca4627f68575a54d3ad4bf23df13b4', 'title': 'Content Writing'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'approved_on': '29-06-2021', 'text': 'Branch Branch Section 4.1 of RFP TEST_REPLY ', 'clean_text': 'branch branch section 41 rfp testrepli', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60dadc2bee05e644d6302f34'), 'upc_code': '0301/01/01/DL', 'As per Tender': 'Branch 1', 'Clarification sought / modification suggested': 'Please let us know the deadline', 'Clause': 'Section 4.1 of RFP', 'cutoff_time': '30-06-2021', 'recipient_id': 'sachin@envirya.in', 'recipient_user': {'department': {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, 'designation': 'IT', 'email': 'sachin@envirya.in', 'id': '60d04eb7e805768ebee9229d', 'is_deleted': False, 'name': 'Sachin', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, {'id': 'c9ca4627f68575a54d3ad4bf23df13b4', 'title': 'Content Writing'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': {'email': 'subham306952@gmail.com'}, 'status': 'approved', 'Clarification': 'TEST_REPLY_2', 'pr_count': 0, 'text': 'Branch 1 Please let us know the deadline Section 4.1 of RFP TEST_REPLY_2', 'clean_text': 'branch 1 pleas let us know deadlin section 41 rfp testreply2', 'zone': 'Delhi', 'query_id': 'ORPQEOTH83U7', 'created_on': '29-06-2021', 'contract_type': 'EPC', 'approved_on': '29-06-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60d5ac7f2fe3b8555370bf67'), 'upc_code': '0301/01/01/DL', 'As per Tender': 'The cost of the project is 30 lakhs', 'Clarification sought / modification suggested': 'Please let us know the deadline', 'Clause': '1.2 of SCHEDULE E of DCA', 'cutoff_time': '26-06-2021', 'recipient_id': 'sachin@envirya.in', 'recipient_user': {'department': {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, 'designation': 'IT', 'email': 'sachin@envirya.in', 'id': '60d04eb7e805768ebee9229d', 'is_deleted': False, 'name': 'Sachin', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, {'id': 'c9ca4627f68575a54d3ad4bf23df13b4', 'title': 'Content Writing'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': {'email': 'subham306952@gmail.com'}, 'status': 'approved', 'Clarification': '1.2 of SCHEDULE  REPLY', 'pr_count': 0, 'text': 'The cost of the project is 30 lakhs Please let us know the deadline 1.2 of SCHEDULE E of DCA 1.2 of SCHEDULE  REPLY', 'clean_text': 'the cost project 30 lakh pleas let us know deadlin 12 schedul e dca 12 schedul repli', 'zone': 'Delhi', 'query_id': 'X4MOMBLNHAEI', 'created_on': '25-06-2021', 'contract_type': 'EPC', 'approved_on': '29-06-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60dae7ffee05e644d6302f38'), 'upc_code': '0301/01/01/DL', 'As per Tender': 'During the Construction Period, the Concessionaire shall maain, at its cost, the existing Project Highway to ensure that the road is in pothole free condition is maained , and shall undertake the necessary repair and maenance works for this purpose; provided that the Concessionaire may, at its cost, errupt and divert the Users and other persons if such erruption and diversion is necessary for the efficient progress of Construction Works and conforms to Good Industry Practice..', 'Clarification sought / modification suggested': 'Please let us know the deadline for this', 'Clause': 'Section 21.1 of RFP', 'cutoff_time': '30-06-2021', 'recipient_id': 'sachin@envirya.in', 'recipient_user': {'department': {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, 'designation': 'IT', 'email': 'sachin@envirya.in', 'id': '60d04eb7e805768ebee9229d', 'is_deleted': False, 'name': 'Sachin', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, {'id': 'c9ca4627f68575a54d3ad4bf23df13b4', 'title': 'Content Writing'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': {'email': 'subham306952@gmail.com'}, 'status': 'approved', 'Clarification': 'Agreed, when EOT is necessary\nand granted due to default of\nAuthority, Concessionaire shall\nbe paid maenance cost of\nexisting road as per Cl.6.2.1', 'pr_count': 0, 'text': 'During the Construction Period, the Concessionaire shall maain, at its cost, the existing Project Highway to ensure that the road is in pothole free condition is maained , and shall undertake the necessary repair and maenance works for this purpose; provided that the Concessionaire may, at its cost, errupt and divert the Users and other persons if such erruption and diversion is necessary for the efficient progress of Construction Works and conforms to Good Industry Practice.. Please let us know the deadline for this Section 2.1 of RFP Agreed, when EOT is necessary\nand granted due to default of\nAuthority, Concessionaire shall\nbe paid maenance cost of\nexisting road as per Cl.6.2.1', 'clean_text': 'dure construct period concessionair shall maain cost exist project highway ensur road pothol free condit maain shall undertak necessari repair maen work purpos provid concessionair may cost errupt divert user person errupt divers necessari effici progress construct work conform good industri practic pleas let us know deadlin section 21 rfp agre eot necessari grant due default author concessionair shall paid maen cost exist road per cl621', 'zone': 'Delhi', 'query_id': 'Y4HNCQH69BAQ', 'created_on': '29-06-2021', 'contract_type': 'EPC', 'approved_on': '29-06-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60daf396ee05e644d6302f39'), 'upc_code': '0301/01/01/DL', 'As per Tender': 'Upon receipt of information set forth in Clause 16.2.2, if the Authority decides to proceed with the Change of Scope, it shall convey its preferred option to the Concessionaire, and the Parties shall, with assistance of the Independent Engineer, thereupon make good faith efforts to agree upon the time and costs for implementation thereof. Upon reaching an agreement, the Authority shall issue an order (the “Change of Scope Order”)', 'Clarification sought / modification suggested': 'Authority is requested to clarify the timelines for issuance of COS Order and remedies to the Concessionaire, if the Authority fails to adhere the same', 'Clause': 'Article 2.1 of DCA', 'cutoff_time': '02-07-2021', 'recipient_id': 'sachin@envirya.in', 'recipient_user': {'department': {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, 'designation': 'IT', 'email': 'sachin@envirya.in', 'id': '60d04eb7e805768ebee9229d', 'is_deleted': False, 'name': 'Sachin', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, {'id': 'c9ca4627f68575a54d3ad4bf23df13b4', 'title': 'Content Writing'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': {'email': 'subham306952@gmail.com'}, 'status': 'approved', 'Clarification': 'The timelines are defined for\nPayment of Change of Scope as\nper Article 16.3. However no\ntimeline is given for issuance of\nCOS order as the same depends\non agreement/disagreement on\ntime\nand\ncosts\nfor\nimplementation of COS. Refer\nArticle 16.2.3.', 'pr_count': 0, 'text': 'Upon receipt of information set forth in Clause 16.2.2, if the Authority decides to proceed with the Change of Scope, it shall convey its preferred option to the Concessionaire, and the Parties shall, with assistance of the Independent Engineer, thereupon make good faith efforts to agree upon the time and costs for implementation thereof. Upon reaching an agreement, the Authority shall issue an order (the “Change of Scope Order”) Authority is requested to clarify the timelines for issuance of COS Order and remedies to the Concessionaire, if the Authority fails to adhere the same Article 2.1 of DCA The timelines are defined for\nPayment of Change of Scope as\nper Article 16.3. However no\ntimeline is given for issuance of\nCOS order as the same depends\non agreement/disagreement on\ntime\nand\ncosts\nfor\nimplementation of COS. Refer\nArticle 16.2.3.', 'clean_text': 'upon receipt inform set forth claus 1622 author decid proceed chang scope shall convey prefer option concessionair parti shall assist independ engin thereupon make good faith effort agre upon time cost implement thereof upon reach agreement author shall issu order “chang scope order” author request clarifi timelin issuanc cos order remedi concessionair author fail adher articl 21 dca the timelin defin payment chang scope per articl 163 howev timelin given issuanc cos order depend agreementdisagr time cost implement cos refer articl 1623', 'zone': 'Delhi', 'query_id': 'E7AGAAHKID7T', 'created_on': '29-06-2021', 'contract_type': 'EPC', 'approved_on': '29-06-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}, {'_id': ('60dae16dee05e644d6302f35'), 'upc_code': '0301/01/01/DL', 'As per Tender': 'Branch', 'Clarification sought / modification suggested': 'Please let us know the deadline', 'Clause': 'Section 2.1 of RFP', 'cutoff_time': '01-07-2021', 'recipient_id': 'sachin@envirya.in', 'recipient_user': {'department': {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, 'designation': 'IT', 'email': 'sachin@envirya.in', 'id': '60d04eb7e805768ebee9229d', 'is_deleted': False, 'name': 'Sachin', 'otp_sent': False, 'otp_verified': True, 'password': '21232f297a57a5a743894a0e4a801fc3', 'role': {'_id': '603b3770f238b00816846dae', 'role': 'Replier'}, 'zone': {'departments': [{'id': '73595e157019f972a82f2fea61332a73', 'title': 'Information Technology'}, {'id': '7cb15e416d62919b1b40298324fbe30b', 'title': 'Marketing'}, {'id': 'c9ca4627f68575a54d3ad4bf23df13b4', 'title': 'Content Writing'}], 'id': '9baaebe1759ba1a6365a2b0539081516', 'title': 'Delhi'}}, 'sender_id': {'email': 'subham306952@gmail.com'}, 'status': 'approved', 'Clarification': 'TEST', 'pr_count': 1, 'text': 'Branch Please let us know the deadline Section 2.1 of RFP TEST', 'clean_text': 'branch pleas let us know deadlin section 21 rfp test', 'zone': 'Delhi', 'query_id': 'VSOXKZQDV577', 'created_on': '29-06-2021', 'contract_type': 'EPC', 'approved_on': '01-07-2021', 'project_name': 'Dwarka Expressway - Package I from Shiv Murti ersection of NH 8 till Rail under Bidge RuB near Dwarka Sector 21 (5 km.) - EPC (Rs.2507.06 crore) (NH - 8) , (BDD - 10-05-2018)'}]

input_clause_search = "Section 4.1 of RFP".lower()

start_time_1 = time.time()
input_list=[]
for items in hist_data:
    if (input_clause_search in items["Clause"].lower()):
        input_list.append(items)

print("time1", time.time()  - start_time_1 )




start_time_2 = time.time()
clause_array = np.array([v["Clause"].lower() for v in hist_data])
def compare(input_clause_search, items):
    if (input_clause_search in items):
        return True
    else:
        return False

a=list( map(compare,np.array(len(clause_array) * [input_clause_search]), clause_array))
print("time2", time.time()  - start_time_2 )


start_time_3 = time.time()
clause_array = np.array([v["Clause"].lower() for v in hist_data])
result = clause_array[input_clause_search  in clause_array]
print("time3", time.time()  - start_time_3 )
